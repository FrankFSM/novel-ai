import{_ as J,u as K,P as Q,A as w,o as H,B as f,c as O,b as o,d as l,aJ as U,i as u,w as n,l as W,aK as X,f as s,e as r,h as Y,g as _,t as c,Q as x,R as D,s as Z,k as ee,G as te,n as ne,p as oe,$ as ae,a7 as se,a8 as ie,ak as re,j as L,ab as le}from"./index-9820d523.js";/* empty css                   *//* empty css                         *//* empty css                *//* empty css                   *//* empty css               *//* empty css                 *//* empty css                         */import{l as ce}from"./location-23ef2fff.js";const de={class:"location-events-container"},ue={class:"page-header"},_e={class:"header-left"},pe={key:0},fe={key:1},ve={key:0,class:"loading-container"},me={key:2,class:"events-content"},he={class:"location-info"},ye={class:"location-avatar"},ge={class:"location-details"},ke={class:"location-name"},Ee={class:"location-description"},Ie={key:1,class:"events-timeline"},Ce={class:"event-header"},we={class:"event-name"},xe={class:"event-description"},De={key:0,class:"event-participants"},Le={class:"participants-list"},Te={__name:"LocationEvents",props:{locationId:{type:Number,required:!0},novelId:{type:Number,required:!0}},setup(T){const v=K();Q();const d=T,a=w(null),p=w(!1);H(async()=>{d.locationId?await b():f.warning("未提供有效的地点ID")});async function b(){if(d.locationId)try{p.value=!0;const e=await ce.getLocationDetails(d.locationId);console.log("地点详情API响应:",e),e?(a.value=e,f.success("成功加载地点事件数据")):f.warning("地点详情数据为空")}catch(e){console.error("获取地点详情失败:",e),f.error("获取地点详情失败: "+(e.message||"未知错误"))}finally{p.value=!1}}function k(){v.go(-1)}function B(){v.push({name:"LocationDetail",params:{locationId:d.locationId},query:{novelId:d.novelId}})}function A(e){v.push({path:"/analysis/characters/journey",query:{novelId:d.novelId,characterId:e}})}function E(e){return a.value.characters.slice(0,3)}const N=O(()=>!a.value||!a.value.events?[]:[...a.value.events].sort((e,t)=>e.chapter_id&&t.chapter_id?e.chapter_id-t.chapter_id:e.chapter_id?-1:t.chapter_id?1:0));function $(e){return e.time_description?e.time_description:e.chapter_id?`第${e.chapter_id}章`:"未知时间"}function q(e){return e?e>=4?"danger":e>=3?"warning":e>=2?"success":"info":"info"}function V(e){return e?e>=4?"#F56C6C":e>=3?"#E6A23C":e>=2?"#67C23A":"#909399":"#909399"}function z(e){return e?e>=4?"danger":e>=3?"warning":e>=2?"success":"info":"info"}function P(e){const t=["castle","home","mountain","forest","city","beach","cave","building","palace","village"],m=e%t.length;return`https://api.dicebear.com/7.x/bottts/svg?seed=${t[m]}_${e}`}return(e,t)=>{const m=Z,h=ee,R=te,I=ne,j=oe,y=ae,F=se,C=W,M=le,S=ie,G=X;return o(),l("div",de,[U((o(),u(C,{shadow:"never"},{header:n(()=>[s("div",ue,[s("div",_e,[r(h,{type:"text",onClick:k},{default:n(()=>[r(m,null,{default:n(()=>[r(Y(re))]),_:1}),t[0]||(t[0]=_(" 返回 "))]),_:1}),a.value?(o(),l("h2",pe,c(a.value.name)+" - 事件",1)):(o(),l("h2",fe,"地点事件"))])])]),default:n(()=>[p.value?(o(),l("div",ve,[r(R,{rows:10,animated:""})])):a.value?(o(),l("div",me,[s("div",he,[s("div",ye,[r(j,{size:80,src:P(a.value.id)},null,8,["src"])]),s("div",ge,[s("h3",ke,c(a.value.name),1),s("div",Ee,c(a.value.description||"暂无描述"),1)])]),r(F,null,{default:n(()=>[r(y,{type:"info"},{default:n(()=>t[2]||(t[2]=[_("事件时间线")])),_:1})]),_:1}),!a.value.events||a.value.events.length===0?(o(),u(I,{key:0,description:"该地点尚无相关事件"},{default:n(()=>[r(h,{type:"primary",onClick:B},{default:n(()=>t[3]||(t[3]=[_("查看地点详情")])),_:1})]),_:1})):(o(),l("div",Ie,[r(S,null,{default:n(()=>[(o(!0),l(x,null,D(N.value,i=>(o(),u(M,{key:i.id,type:q(i.importance),color:V(i.importance),timestamp:$(i)},{default:n(()=>[r(C,{class:"event-card"},{header:n(()=>[s("div",Ce,[s("span",we,c(i.name),1),i.importance?(o(),u(y,{key:0,type:z(i.importance),size:"small"},{default:n(()=>[_(" 重要性: "+c(i.importance),1)]),_:2},1032,["type"])):L("",!0)])]),default:n(()=>[s("div",xe,c(i.description||"暂无描述"),1),E(i).length>0?(o(),l("div",De,[t[4]||(t[4]=s("div",{class:"participants-label"},"相关角色:",-1)),s("div",Le,[(o(!0),l(x,null,D(E(i),g=>(o(),u(y,{key:g.id,type:"success",size:"small",style:{margin:"2px 4px"},onClick:be=>A(g.id)},{default:n(()=>[_(c(g.name),1)]),_:2},1032,["onClick"]))),128))])])):L("",!0)]),_:2},1024)]),_:2},1032,["type","color","timestamp"]))),128))]),_:1})]))])):(o(),u(I,{key:1,description:"地点数据不存在或尚未加载"},{default:n(()=>[r(h,{type:"primary",onClick:k},{default:n(()=>t[1]||(t[1]=[_("返回地点列表")])),_:1})]),_:1}))]),_:1})),[[G,p.value]])])}}},je=J(Te,[["__scopeId","data-v-5a7ca3c7"]]);export{je as default};
