import{_ as U,u as z,a as Q,A as k,c as F,o as G,B as _,b as u,d as h,e as l,w as a,l as j,C as H,f as c,g as n,h as J,i as C,t as m,D as f,F as K,k as O,G as P,n as W,p as X,q as Y,r as Z}from"./index-9820d523.js";/* empty css                   *//* empty css                *//* empty css                        *//* empty css               *//* empty css                 *//* empty css                         *//* empty css                 */const ee={class:"novel-list-container"},te={class:"list-header"},oe={class:"header-actions"},le={class:"list-content"},ae={key:0,class:"loading-container"},ne={key:0},se={class:"dialog-footer"},re={__name:"NovelList",setup(ie){const y=z(),r=Q(),v=k(""),p=k(!1),i=k(null),g=F(()=>{if(!v.value)return r.novels;const o=v.value.toLowerCase();return r.novels.filter(e=>e.title.toLowerCase().includes(o)||e.author.toLowerCase().includes(o))});G(async()=>{try{await r.fetchNovels()}catch{_.error("获取小说列表失败")}});const b=()=>{},N=()=>{y.push("/novels/upload")},E=o=>{y.push(`/novels/detail/${o}`)},D=o=>{r.setCurrentNovel(o),y.push("/qa")},x=async o=>{try{await r.fetchNovelDetail(o),_.success("小说详情加载成功")}catch{_.error("获取小说详情失败")}},V=o=>{i.value=o,p.value=!0},L=async()=>{if(i.value)try{await r.deleteNovel(i.value.id),p.value=!1,_.success(`小说《${i.value.title}》删除成功`),i.value=null}catch{_.error("删除小说失败")}},$=o=>{E(o.id)},B=o=>o?new Date(o).toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}):"-";return(o,e)=>{const S=K,s=O,T=P,q=W,A=X,d=Y,I=Z,M=j,R=H;return u(),h("div",ee,[l(M,{shadow:"never"},{header:a(()=>[c("div",te,[e[4]||(e[4]=c("h2",null,"小说管理",-1)),c("div",oe,[l(S,{modelValue:v.value,"onUpdate:modelValue":e[0]||(e[0]=t=>v.value=t),placeholder:"搜索小说标题或作者","prefix-icon":"Search",clearable:"",onClear:b,onInput:b,style:{width:"300px","margin-right":"16px"}},null,8,["modelValue"]),l(s,{type:"primary",onClick:N},{default:a(()=>e[3]||(e[3]=[n("上传新小说")])),_:1})])])]),default:a(()=>[c("div",le,[J(r).loading?(u(),h("div",ae,[l(T,{rows:10,animated:""})])):g.value.length===0?(u(),C(q,{key:1,description:"暂无小说，点击上方按钮上传"},{default:a(()=>[l(s,{type:"primary",onClick:N},{default:a(()=>e[5]||(e[5]=[n("上传新小说")])),_:1})]),_:1})):(u(),C(I,{key:2,data:g.value,style:{width:"100%"},"row-key":"id",border:"",stripe:"",onRowClick:$},{default:a(()=>[l(d,{label:"封面",width:"80"},{default:a(t=>[l(A,{shape:"square",size:50,src:t.row.cover_url||"https://cube.elemecdn.com/3/7c/3ea6beec64369c2642b92c6726f1epng.png",fit:"cover"},null,8,["src"])]),_:1}),l(d,{prop:"title",label:"标题","min-width":"180"}),l(d,{prop:"author",label:"作者","min-width":"120"}),l(d,{label:"创建时间","min-width":"180"},{default:a(t=>[n(m(B(t.row.created_at)),1)]),_:1}),l(d,{label:"统计","min-width":"120"},{default:a(t=>[t.row.chapters_count!==void 0?(u(),h("span",ne,m(t.row.chapters_count)+" 章节 / "+m(t.row.characters_count||0)+" 角色 ",1)):(u(),C(s,{key:1,link:"",type:"primary",onClick:f(w=>x(t.row.id),["stop"])},{default:a(()=>e[6]||(e[6]=[n(" 加载统计 ")])),_:2},1032,["onClick"]))]),_:1}),l(d,{fixed:"right",label:"操作",width:"200"},{default:a(t=>[l(s,{link:"",type:"primary",onClick:f(w=>E(t.row.id),["stop"])},{default:a(()=>e[7]||(e[7]=[n(" 查看详情 ")])),_:2},1032,["onClick"]),l(s,{link:"",type:"primary",onClick:f(w=>D(t.row.id),["stop"])},{default:a(()=>e[8]||(e[8]=[n(" 开始问答 ")])),_:2},1032,["onClick"]),l(s,{link:"",type:"danger",onClick:f(w=>V(t.row),["stop"])},{default:a(()=>e[9]||(e[9]=[n(" 删除 ")])),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]))])]),_:1}),l(R,{modelValue:p.value,"onUpdate:modelValue":e[2]||(e[2]=t=>p.value=t),title:"确认删除",width:"30%"},{footer:a(()=>[c("span",se,[l(s,{onClick:e[1]||(e[1]=t=>p.value=!1)},{default:a(()=>e[10]||(e[10]=[n("取消")])),_:1}),l(s,{type:"danger",onClick:L},{default:a(()=>e[11]||(e[11]=[n("确定删除")])),_:1})])]),default:a(()=>{var t;return[c("span",null,"确定要删除小说《"+m((t=i.value)==null?void 0:t.title)+"》吗？此操作不可恢复！",1)]}),_:1},8,["modelValue"])])}}},ye=U(re,[["__scopeId","data-v-048457f2"]]);export{ye as default};
