import{_ as Ue,u as qe,P as De,a as Oe,A as T,c as S,o as he,a2 as Q,B as $,a3 as Ge,b as n,d as c,e as l,w as o,l as We,f as a,g as _,h as j,Q as k,R as w,j as E,i as h,t as u,a4 as K,k as He,a1 as Qe,a0 as Ke,G as Xe,n as Ye,M as Ze,T as et,p as tt,$ as at,I as st,V as lt,a5 as nt,a6 as ot,a7 as rt,a8 as it,W as ct,a9 as ut,aa as fe,H as dt,ab as pt,ac as vt,ad as _t,s as mt,ae as ht}from"./index-9820d523.js";/* empty css                    *//* empty css                *//* empty css                 *//* empty css                         *//* empty css                   */import{i as ft,L as yt}from"./echarts-681c53bb.js";/* empty css                *//* empty css               *//* empty css                         *//* empty css                  *//* empty css                 *//* empty css                  */import{u as gt}from"./analysis-dd34ca86.js";import{c as bt}from"./character-cf834eae.js";const kt={class:"journey-container"},wt={class:"page-header"},Et={class:"title-with-back"},Ct={class:"header-actions"},xt={key:0,class:"loading-container"},Vt={key:2,class:"loading-container"},zt={key:5,class:"journey-content"},Tt={style:{display:"flex","align-items":"center",gap:"20px"}},At={style:{flex:"1"}},St={class:"character-info"},Mt={class:"character-avatar"},$t={class:"character-details"},jt={class:"character-name"},It={class:"character-description"},Nt={key:0,class:"character-aliases"},Lt={class:"character-stats"},Rt={class:"stat-item"},Ft={class:"stat-value"},Bt={class:"stat-item"},Jt={class:"stat-value"},Pt={class:"stat-item"},Ut={class:"stat-value"},qt={class:"journey-visualization"},Dt={class:"stages-container"},Ot={key:1},Gt={key:0,class:"stages-summary"},Wt={class:"stage-details"},Ht={key:0,class:"stage-chapter"},Qt={key:1,class:"stage-events"},Kt={class:"events-container"},Xt={key:1},Yt={class:"events-filter"},Zt={class:"filter-item"},ea={class:"filter-item"},ta={class:"event-card"},aa={class:"event-header"},sa={key:0,class:"event-participants"},la={key:1,class:"event-location"},na={class:"emotions-container"},oa={key:1},ra={class:"emotions-summary"},ia={class:"emotion-value"},ca={class:"emotion-markers"},ua={class:"markers-list"},da={class:"marker-chapter"},pa={key:0,class:"marker-event"},va={class:"relationships-container"},_a={key:1},ma={class:"relationship-filters"},ha={class:"filter-item"},fa={class:"filter-item"},ya={key:0,class:"relationship-groups"},ga={class:"relationship-list"},ba={class:"relationship-content"},ka={class:"relationship-avatars"},wa={class:"relationship-info"},Ea={class:"relationship-title"},Ca={class:"character-name"},xa={class:"target-name"},Va={class:"relationship-description"},za={key:0,class:"relationship-first-chapter"},Ta={key:1,class:"relationship-strength"},Aa={class:"strength-value"},Sa={key:1,class:"relationship-groups"},Ma={class:"group-title"},$a={class:"group-count"},ja={class:"relationship-list"},Ia={class:"relationship-content"},Na={class:"relationship-avatars"},La={class:"relationship-info"},Ra={class:"relationship-title"},Fa={class:"character-name"},Ba={class:"target-name"},Ja={class:"relationship-description"},Pa={key:0,class:"relationship-first-chapter"},Ua={key:1,class:"relationship-strength"},qa={class:"strength-value"},Da={__name:"CharacterJourney",setup(Oa){const F=qe(),U=De(),B=Oe(),x=gt(),f=T(null),b=T(null),M=T([]),J=T(!1),L=T("stages"),X=T(null);let V=null;const r=S(()=>x.characterJourney||null),Y=S(()=>`https://avatars.dicebear.com/api/avataaars/${b.value||"default"}.svg`);S(()=>{if(!f.value)return"";const t=B.novels.find(e=>e.id===Number(f.value));return t?t.title:""}),S(()=>{if(!b.value)return"";const t=M.value.find(e=>e.id===Number(b.value));return t?t.name:""});const q=T(""),Z=T("asc"),ye=[{label:"关键转折点",value:"critical"},{label:"重要事件",value:"major"},{label:"普通事件",value:"normal"},{label:"次要事件",value:"minor"}],ge=S(()=>{var e;if(!((e=r.value)!=null&&e.key_events))return[];let t=r.value.key_events;return q.value&&(t=t.filter(i=>i.importance_level===q.value)),t.slice().sort((i,p)=>{const d=i.chapter_id||0,m=p.chapter_id||0;return Z.value==="asc"?d-m:m-d})}),P=T(""),D=T("importance"),be=[{label:"师徒关系",value:"师徒"},{label:"朋友关系",value:"朋友"},{label:"敌对关系",value:"敌人"},{label:"亲人关系",value:"亲人"},{label:"爱情关系",value:"恋人"},{label:"同门关系",value:"同门"}],se=S(()=>{var e;if(!((e=r.value)!=null&&e.relationships))return[];let t=r.value.relationships;return P.value&&(t=t.filter(i=>i.relation_type===P.value)),le(t)}),ke=S(()=>{var e;if(!((e=r.value)!=null&&e.relationships))return{};const t={};return r.value.relationships.forEach(i=>{const p=i.relation_type||"其他";t[p]||(t[p]=[]),t[p].push(i)}),Object.keys(t).forEach(i=>{t[i]=le(t[i])}),t});function le(t){return[...t].sort((e,i)=>D.value==="chapter"?(e.first_chapter_id||9999)-(i.first_chapter_id||9999):D.value==="name"?(e.target_character_name||"").localeCompare(i.target_character_name||""):(i.strength||0)-(e.strength||0))}he(async()=>{B.novels.length===0&&await B.fetchNovels();const t=Number(U.query.novelId),e=Number(U.query.characterId);t&&!isNaN(t)&&(f.value=t,await ee(t),e&&!isNaN(e)&&M.value.find(i=>i.id===e)&&(b.value=e,O()))}),Q(L,async t=>{t==="emotions"&&r.value&&!V&&(await K(),G())}),Q(r,async()=>{L.value==="emotions"&&r.value&&(await K(),G())});async function ee(t,e=!1){if(t)try{M.value=[],J.value=!0;const i=await bt.analyzeCharacters(t,e);console.log("角色分析API响应:",i),i&&Array.isArray(i)?(M.value=i,$.success(`成功加载小说角色，共发现${i.length}个角色`)):($.warning("获取到的角色列表为空"),M.value=[])}catch(i){console.error("获取角色列表失败:",i),$.error("获取角色列表失败: "+(i.message||"未知错误")),M.value=[]}finally{J.value=!1}}async function we(t){f.value=Number(t),b.value=null,x.reset(),await ee(t),F.replace({query:{...U.query,novelId:t,characterId:void 0}})}function Ee(t){b.value=Number(t),x.reset(),F.replace({query:{...U.query,characterId:t}})}async function O(){if(!f.value||!b.value){$.warning("请先选择小说和角色");return}try{console.log(`正在生成角色旅程，小说ID: ${f.value}，角色ID: ${b.value}`),await x.fetchCharacterJourney(f.value,b.value),x.characterJourney?$.success("角色旅程生成成功"):x.error&&$.error(`生成失败: ${x.error}`)}catch(t){console.error("生成角色旅程出错:",t),$.error(`生成角色旅程失败: ${t.message||"未知错误"}`)}}const Ce=S(()=>{var e;if(!((e=r.value)!=null&&e.emotions)||!r.value.emotions.length)return{chapters:[],values:[]};const t=[...r.value.emotions].sort((i,p)=>i.chapter_id-p.chapter_id);return{chapters:t.map(i=>`第${i.chapter_id}章`),values:t.map(i=>i.value)}}),te=S(()=>{var e,i,p;if(!((e=r.value)!=null&&e.emotions)||!((p=(i=r.value)==null?void 0:i.journey)!=null&&p.events))return[];const t={};return r.value.journey.events.forEach(d=>{d.chapter_id&&(!t[d.chapter_id]||t[d.chapter_id].importance<d.importance)&&(t[d.chapter_id]=d)}),r.value.emotions.map(d=>({...d,event:t[d.chapter_id]||null})).sort((d,m)=>d.chapter_id-m.chapter_id)}),xe=t=>t<4?"emotion-negative":t>7?"emotion-positive":"emotion-neutral",Ve=t=>t?t>=5?"danger":t>=4?"warning":t>=3?"success":"info":"info",G=()=>{var p,d;if(!X.value||!((p=r.value)!=null&&p.emotions))return;V&&V.dispose();const t=Ce.value,e=[];te.value.forEach((m,z)=>{m.event&&m.event.importance>=4&&e.push({name:m.event.name,value:m.event.name,xAxis:z,yAxis:m.value,itemStyle:{color:m.event.importance>=5?"#F56C6C":"#E6A23C"},tooltilp:{formatter:function(A){return`${A.name}<br/>${m.event.description}`}}})});const i=((d=r.value.stats)==null?void 0:d.emotion_avg)||0;V=ft(X.value),V.setOption({title:{text:"角色情感变化曲线",left:"center"},tooltip:{trigger:"axis",formatter:function(m){const z=m[0].dataIndex,A=te.value[z];let I=m[0].name+"<br/>情感值: "+m[0].value.toFixed(1);return A&&A.event&&(I+="<br/>事件: "+A.event.name,A.event.description&&(I+="<br/>描述: "+A.event.description)),I}},xAxis:{type:"category",data:t.chapters,axisLabel:{interval:Math.ceil(t.chapters.length/10)}},yAxis:{type:"value",min:0,max:10,name:"情感值",nameLocation:"end",nameTextStyle:{padding:[0,0,0,-30]},axisLabel:{formatter:"{value}"}},series:[{name:"情感值",type:"line",data:t.values,smooth:!0,symbolSize:8,lineStyle:{width:3},areaStyle:{color:new yt(0,0,0,1,[{offset:0,color:"rgba(128, 255, 165, 0.3)"},{offset:1,color:"rgba(1, 191, 236, 0.1)"}])},markLine:{data:[{name:"平均值",yAxis:i,lineStyle:{color:"#409EFF",type:"dashed"},label:{formatter:"平均情感值: {c}"}}]},markPoint:{data:e}}],grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0}})};Q(()=>r.value,async()=>{await K(),L.value==="emotions"&&G()},{deep:!0}),Q(()=>L.value,async t=>{t==="emotions"&&(await K(),G())});const ne=()=>{V&&V.resize()};he(()=>{window.addEventListener("resize",ne)}),Ge(()=>{window.removeEventListener("resize",ne),V&&(V.dispose(),V=null)});function ze(){f.value?F.push({path:"/analysis/characters/list",query:{novelId:f.value}}):F.push("/analysis/characters/list")}function Te(){F.push("/novels/list")}function Ae(t){return{critical:"danger",major:"warning",normal:"primary",minor:"info"}[t.importance_level]||"primary"}function Se(t){return{critical:"#F56C6C",major:"#E6A23C",normal:"#409EFF",minor:"#909399"}[t.importance_level]||""}function Me(t){return{critical:"danger",major:"warning",normal:"",minor:"info"}[t]||""}function $e(t){return{critical:"关键转折点",major:"重要事件",normal:"普通事件",minor:"次要事件"}[t]||"未知类型"}function oe(t){return{师徒:"success",朋友:"info",敌人:"danger",亲人:"warning",恋人:"",同门:"info"}[t]||""}function re(t){return t>=80?"#67C23A":t>=50?"#409EFF":t>=30?"#E6A23C":"#909399"}function je(t,e=""){const i={初登场:"bottts/stage-intro.svg",成长:"bottts/stage-growth.svg",转折:"bottts/stage-turning.svg",高潮:"bottts/stage-climax.svg",结局:"bottts/stage-finale.svg"};let p="bottts/stage-default.svg";for(const[d,m]of Object.entries(i))if(e.includes(d)){p=m;break}if(p==="bottts/stage-default.svg"){const d=["bottts/stage1.svg","bottts/stage2.svg","bottts/stage3.svg","bottts/stage4.svg","bottts/stage5.svg"];p=d[t%d.length]}return`https://avatars.dicebear.com/api/${p}`}function ie(t){return`https://avatars.dicebear.com/api/avataaars/${t||Math.random()}.svg`}async function Ie(){if(f.value)try{await ee(f.value,!0)}catch{$.error("分析角色失败")}}return(t,e)=>{const i=He,p=Qe,d=Ke,m=Xe,z=Ye,A=Ze,I=et,R=tt,g=at,W=We,Ne=dt,Le=st,H=lt,ce=nt,Re=ot,ue=rt,Fe=pt,Be=it,ae=vt,Je=_t,de=mt,pe=ht,Pe=ct;return n(),c("div",kt,[l(W,{shadow:"never"},{header:o(()=>[a("div",wt,[a("div",Et,[l(i,{type:"text",onClick:ze,icon:"ArrowLeft"},{default:o(()=>e[7]||(e[7]=[_(" 返回列表 ")])),_:1}),e[8]||(e[8]=a("h2",null,"角色旅程分析",-1))]),a("div",Ct,[l(d,{modelValue:f.value,"onUpdate:modelValue":e[0]||(e[0]=s=>f.value=s),placeholder:"请选择小说",onChange:we,loading:j(B).loading,class:"select-with-label"},{default:o(()=>[(n(!0),c(k,null,w(j(B).novels,s=>(n(),h(p,{key:s.id,label:s.title,value:s.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","loading"]),l(d,{modelValue:b.value,"onUpdate:modelValue":e[1]||(e[1]=s=>b.value=s),placeholder:"选择角色",onChange:Ee,disabled:!f.value||!M.value.length,loading:J.value,class:"select-with-label"},{default:o(()=>[(n(!0),c(k,null,w(M.value,s=>(n(),h(p,{key:s.id,label:s.name,value:s.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","disabled","loading"]),l(i,{type:"primary",onClick:Ie,disabled:!f.value,loading:J.value},{default:o(()=>e[9]||(e[9]=[_(" 分析角色 ")])),_:1},8,["disabled","loading"]),l(i,{type:"primary",onClick:O,disabled:!f.value||!b.value,loading:j(x).loading},{default:o(()=>e[10]||(e[10]=[_(" 生成角色旅程 ")])),_:1},8,["disabled","loading"])])])]),default:o(()=>[J.value?(n(),c("div",xt,[l(m,{rows:5,animated:""}),e[11]||(e[11]=a("div",{class:"loading-text"},"正在分析小说角色...",-1))])):E("",!0),!f.value||!b.value?(n(),h(z,{key:1,description:"请从上方选择小说和角色"},{default:o(()=>[l(i,{type:"primary",onClick:Te},{default:o(()=>e[12]||(e[12]=[_("浏览小说列表")])),_:1})]),_:1})):j(x).loading?(n(),c("div",Vt,[l(m,{rows:15,animated:""})])):j(x).error?(n(),h(A,{key:3,icon:"error",title:"加载失败","sub-title":j(x).error},{extra:o(()=>[l(i,{type:"primary",onClick:O},{default:o(()=>e[13]||(e[13]=[_("重试")])),_:1})]),_:1},8,["sub-title"])):r.value?(n(),c("div",zt,[l(W,{class:"character-info-card"},{default:o(()=>[l(m,{loading:!r.value.character,animated:""},{template:o(()=>[a("div",Tt,[l(I,{variant:"circle",style:{width:"80px",height:"80px"}}),a("div",At,[l(I,{variant:"text",style:{width:"30%",height:"20px"}}),l(I,{variant:"text",style:{width:"70%","margin-top":"15px"}})])])]),default:o(()=>{var s,y,v,C,N,ve,_e;return[a("div",St,[a("div",Mt,[l(R,{size:80,src:Y.value},null,8,["src"])]),a("div",$t,[a("h3",jt,[_(u(((s=r.value.character)==null?void 0:s.name)||"未知角色")+" ",1),(y=r.value.character)!=null&&y.is_main?(n(),h(g,{key:0,type:"danger",size:"small"},{default:o(()=>e[15]||(e[15]=[_("主角")])),_:1})):E("",!0)]),a("div",It,u(((v=r.value.character)==null?void 0:v.description)||"暂无描述"),1),(C=r.value.character)!=null&&C.alias&&r.value.character.alias.length?(n(),c("div",Nt,[e[16]||(e[16]=a("span",{class:"aliases-label"},"别名：",-1)),(n(!0),c(k,null,w(r.value.character.alias,me=>(n(),h(g,{key:me,size:"small",effect:"plain",style:{"margin-right":"5px"}},{default:o(()=>[_(u(me),1)]),_:2},1024))),128))])):E("",!0)]),a("div",Lt,[a("div",Rt,[a("div",Ft,u(((N=r.value.stats)==null?void 0:N.chapters_count)||0),1),e[17]||(e[17]=a("div",{class:"stat-label"},"出场章节",-1))]),a("div",Bt,[a("div",Jt,u(((ve=r.value.stats)==null?void 0:ve.events_count)||0),1),e[18]||(e[18]=a("div",{class:"stat-label"},"相关事件",-1))]),a("div",Pt,[a("div",Ut,u(((_e=r.value.stats)==null?void 0:_e.relationships_count)||0),1),e[19]||(e[19]=a("div",{class:"stat-label"},"人物关系",-1))])])])]}),_:1},8,["loading"])]),_:1}),a("div",qt,[l(Pe,{modelValue:L.value,"onUpdate:modelValue":e[6]||(e[6]=s=>L.value=s)},{default:o(()=>[l(H,{label:"发展阶段",name:"stages"},{default:o(()=>[a("div",Dt,[!r.value.stages||!r.value.stages.length?(n(),h(z,{key:0,description:"暂无发展阶段数据"})):(n(),c("div",Ot,[r.value.journey&&r.value.journey.summary?(n(),c("div",Gt,[e[20]||(e[20]=a("h3",null,"角色旅程概述",-1)),a("p",null,u(r.value.journey.summary),1)])):E("",!0),l(Le,{active:r.value.stages.length,"finish-status":"success",space:220,direction:"vertical"},{default:o(()=>[(n(!0),c(k,null,w(r.value.stages,(s,y)=>(n(),h(Ne,{key:y,title:s.name,description:s.description},{icon:o(()=>[l(R,{size:40,src:je(y,s.name)},null,8,["src"])]),description:o(()=>[a("div",Wt,[a("p",null,u(s.description),1),s.start_chapter&&s.end_chapter?(n(),c("div",Ht,[l(g,{size:"small",effect:"plain"},{default:o(()=>[_("第"+u(s.start_chapter)+"章 - 第"+u(s.end_chapter)+"章",1)]),_:2},1024)])):E("",!0),s.key_events&&s.key_events.length?(n(),c("div",Qt,[e[21]||(e[21]=a("div",{class:"stage-events-title"},"关键事件：",-1)),(n(!0),c(k,null,w(s.key_events,v=>(n(),h(g,{key:v,size:"small",effect:"light",style:{"margin-right":"5px","margin-bottom":"5px"}},{default:o(()=>[_(u(v),1)]),_:2},1024))),128))])):E("",!0)])]),_:2},1032,["title","description"]))),128))]),_:1},8,["active"])]))])]),_:1}),l(H,{label:"关键事件",name:"events"},{default:o(()=>[a("div",Kt,[!r.value.key_events||!r.value.key_events.length?(n(),h(z,{key:0,description:"暂无关键事件数据"})):(n(),c("div",Xt,[a("div",Yt,[a("div",Zt,[e[22]||(e[22]=a("span",{class:"filter-label"},"事件类型：",-1)),l(d,{modelValue:q.value,"onUpdate:modelValue":e[2]||(e[2]=s=>q.value=s),placeholder:"全部类型",clearable:""},{default:o(()=>[(n(),c(k,null,w(ye,s=>l(p,{key:s.value,label:s.label,value:s.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),a("div",ea,[e[25]||(e[25]=a("span",{class:"filter-label"},"排序方式：",-1)),l(Re,{modelValue:Z.value,"onUpdate:modelValue":e[3]||(e[3]=s=>Z.value=s),size:"small"},{default:o(()=>[l(ce,{label:"asc"},{default:o(()=>e[23]||(e[23]=[_("从早到晚")])),_:1}),l(ce,{label:"desc"},{default:o(()=>e[24]||(e[24]=[_("从晚到早")])),_:1})]),_:1},8,["modelValue"])])]),l(ue),l(Be,null,{default:o(()=>[(n(!0),c(k,null,w(ge.value,(s,y)=>(n(),h(Fe,{key:s.id||`event-${y}`,timestamp:`第${s.chapter_id||"?"}章`,type:Ae(s),color:Se(s),placement:"top",hollow:s.importance_level==="minor"},{default:o(()=>[a("div",ta,[a("div",aa,[a("h4",null,u(s.name||"未命名事件"),1),l(g,{size:"small",type:Me(s.importance_level)},{default:o(()=>[_(u($e(s.importance_level)),1)]),_:2},1032,["type"])]),a("p",null,u(s.description||"暂无描述"),1),s.participants&&s.participants.length?(n(),c("div",sa,[e[26]||(e[26]=a("span",{class:"participants-label"},"相关角色：",-1)),(n(!0),c(k,null,w(s.participants,v=>(n(),h(g,{key:v.character_id,size:"small",style:{"margin-right":"5px"}},{default:o(()=>[_(u(v.character_name),1)]),_:2},1024))),128))])):E("",!0),s.location?(n(),c("div",la,[e[27]||(e[27]=a("span",{class:"location-label"},"发生地点：",-1)),l(g,{type:"warning",size:"small"},{default:o(()=>[_(u(s.location.name),1)]),_:2},1024)])):E("",!0)])]),_:2},1032,["timestamp","type","color","hollow"]))),128))]),_:1})]))])]),_:1}),l(H,{label:"情感变化",name:"emotions"},{default:o(()=>{var s,y,v;return[a("div",na,[!r.value.emotions||!r.value.emotions.length?(n(),h(z,{key:0,description:"暂无情感数据"})):(n(),c("div",oa,[a("div",ra,[e[29]||(e[29]=a("h3",null,"情感变化概述",-1)),a("p",null,[e[28]||(e[28]=_("角色情感平均值：")),a("span",ia,u(((s=r.value.stats)==null?void 0:s.emotion_avg)||0),1)]),((y=r.value.stats)==null?void 0:y.emotion_avg)<4?(n(),h(ae,{key:0,type:"warning",title:"角色情感偏低",description:"该角色情感状态整体偏低，在故事中可能经历了较多负面事件。","show-icon":"",closable:!1})):((v=r.value.stats)==null?void 0:v.emotion_avg)>7?(n(),h(ae,{key:1,type:"success",title:"角色情感积极",description:"该角色情感状态整体良好，在故事中可能经历了较多积极事件。","show-icon":"",closable:!1})):(n(),h(ae,{key:2,type:"info",title:"角色情感平稳",description:"该角色情感状态平稳，经历了起伏的情感变化。","show-icon":"",closable:!1}))]),a("div",{ref_key:"emotionChartContainer",ref:X,class:"emotion-chart-container"},null,512),a("div",ca,[e[30]||(e[30]=a("h4",null,"情感标记点",-1)),a("div",ua,[(n(!0),c(k,null,w(te.value,(C,N)=>(n(),c("div",{key:N,class:"marker-item"},[a("span",da,[l(g,{size:"small",type:"info"},{default:o(()=>[_("第"+u(C.chapter_id)+"章",1)]),_:2},1024)]),a("span",{class:ut(["marker-value",xe(C.value)])},u(Math.round(C.value*10)/10),3),C.event?(n(),c("span",pa,[l(Je,{placement:"top",trigger:"hover",content:C.event.description},{reference:o(()=>[l(g,{type:Ve(C.event.importance)},{default:o(()=>[_(u(C.event.name),1)]),_:2},1032,["type"])]),_:2},1032,["content"])])):E("",!0)]))),128))])])]))])]}),_:1}),l(H,{label:"人物关系",name:"relationships"},{default:o(()=>[a("div",va,[!r.value.relationships||!r.value.relationships.length?(n(),h(z,{key:0,description:"暂无人物关系数据"})):(n(),c("div",_a,[a("div",ma,[a("div",ha,[e[31]||(e[31]=a("span",{class:"filter-label"},"关系类型：",-1)),l(d,{modelValue:P.value,"onUpdate:modelValue":e[4]||(e[4]=s=>P.value=s),placeholder:"全部类型",clearable:""},{default:o(()=>[(n(),c(k,null,w(be,s=>l(p,{key:s.value,label:s.label,value:s.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),a("div",fa,[e[32]||(e[32]=a("span",{class:"filter-label"},"排序方式：",-1)),l(d,{modelValue:D.value,"onUpdate:modelValue":e[5]||(e[5]=s=>D.value=s),placeholder:"排序方式"},{default:o(()=>[l(p,{label:"关系重要性",value:"importance"}),l(p,{label:"首次出现章节",value:"chapter"}),l(p,{label:"角色名称",value:"name"})]),_:1},8,["modelValue"])])]),l(ue,null,{default:o(()=>[l(g,{type:"info"},{default:o(()=>[_("共 "+u(se.value.length)+" 个角色关系",1)]),_:1})]),_:1}),P.value?(n(),c("div",ya,[a("div",ga,[(n(!0),c(k,null,w(se.value,(s,y)=>(n(),h(W,{key:s.id||`relation-${y}`,class:"relationship-card",shadow:"hover"},{default:o(()=>{var v;return[a("div",ba,[a("div",ka,[l(R,{size:40,src:Y.value},null,8,["src"]),l(de,{class:"relation-icon"},{default:o(()=>[l(j(fe))]),_:1}),l(R,{size:40,src:ie(s.target_character_id)},null,8,["src"])]),a("div",wa,[a("div",Ea,[a("span",Ca,u(((v=r.value.character)==null?void 0:v.name)||"未知角色"),1),l(g,{size:"small",type:oe(s.relation_type)},{default:o(()=>[_(u(s.relation_type||"未知关系"),1)]),_:2},1032,["type"]),a("span",xa,u(s.target_character_name||"未知角色"),1)]),a("div",Va,u(s.description||"暂无描述"),1),s.first_chapter_id?(n(),c("div",za,[l(g,{size:"small",effect:"plain"},{default:o(()=>[_("关系建立于第"+u(s.first_chapter_id)+"章",1)]),_:2},1024)])):E("",!0),s.strength?(n(),c("div",Ta,[e[33]||(e[33]=a("span",{class:"strength-label"},"关系强度：",-1)),l(pe,{percentage:s.strength,color:re(s.strength),"stroke-width":10,"show-text":!1},null,8,["percentage","color"]),a("span",Aa,u(s.strength)+"%",1)])):E("",!0)])])]}),_:2},1024))),128))])])):(n(),c("div",Sa,[(n(!0),c(k,null,w(ke.value,(s,y)=>(n(),c("div",{key:y},[a("h3",Ma,[l(g,{type:oe(y),effect:"plain"},{default:o(()=>[_(u(y),1)]),_:2},1032,["type"]),a("span",$a,u(s.length)+"个关系",1)]),a("div",ja,[(n(!0),c(k,null,w(s,(v,C)=>(n(),h(W,{key:v.id||`${y}-${C}`,class:"relationship-card",shadow:"hover"},{default:o(()=>{var N;return[a("div",Ia,[a("div",Na,[l(R,{size:40,src:Y.value},null,8,["src"]),l(de,{class:"relation-icon"},{default:o(()=>[l(j(fe))]),_:1}),l(R,{size:40,src:ie(v.target_character_id)},null,8,["src"])]),a("div",La,[a("div",Ra,[a("span",Fa,u(((N=r.value.character)==null?void 0:N.name)||"未知角色"),1),a("span",Ba,u(v.target_character_name||"未知角色"),1)]),a("div",Ja,u(v.description||"暂无描述"),1),v.first_chapter_id?(n(),c("div",Pa,[l(g,{size:"small",effect:"plain"},{default:o(()=>[_("关系建立于第"+u(v.first_chapter_id)+"章",1)]),_:2},1024)])):E("",!0),v.strength?(n(),c("div",Ua,[e[34]||(e[34]=a("span",{class:"strength-label"},"关系强度：",-1)),l(pe,{percentage:v.strength,color:re(v.strength),"stroke-width":10,"show-text":!1},null,8,["percentage","color"]),a("span",qa,u(v.strength)+"%",1)])):E("",!0)])])]}),_:2},1024))),128))])]))),128))]))]))])]),_:1})]),_:1},8,["modelValue"])])])):(n(),h(z,{key:4,description:"点击上方按钮生成角色旅程"},{default:o(()=>[l(i,{type:"primary",onClick:O},{default:o(()=>e[14]||(e[14]=[_("生成角色旅程")])),_:1})]),_:1}))]),_:1})])}}},rs=Ue(Da,[["__scopeId","data-v-9365ff01"]]);export{rs as default};
